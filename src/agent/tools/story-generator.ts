// ============================================
// Bible Palace Agent Tool â€” ì´ì•¼ê¸° ì—°ê²° ìƒì„±ê¸°
// Loci ì‚¬ì´ë¥¼ ì‡ëŠ” ë‚´ëŸ¬í‹°ë¸Œ ìƒì„±
// ============================================

import type { SeparatorType } from "@/types/palace";

export interface LocusInfo {
  index: number;
  name: string;
  nameEn: string;
  emoji: string;
  description: string;
  separatorBefore?: SeparatorType;
  keyword?: string;
  image?: string;
}

export interface StoryConnection {
  fromLocus: number;
  toLocus: number;
  story: string;
  transitionType: "walk" | "look" | "reach" | "turn" | "open";
}

export interface PalaceNarrative {
  title: string;
  verseRef: string;
  totalLoci: number;
  connections: StoryConnection[];
  fullStory: string;
}

// ============================================
// ì „ì²´ ì•„íŒŒíŠ¸ 20ê°œ ì¥ì†Œ (Full Layout)
// ============================================
export const FULL_APARTMENT_LOCI: LocusInfo[] = [
  {
    index: 0,
    name: "ì•„íŒŒíŠ¸ ì…êµ¬",
    nameEn: "Apartment Entrance",
    emoji: "ğŸ¢",
    description: "ì°¬ ë°”ê¹¥ ê³µê¸°ì™€ ë¡œë¹„ì˜ ë”°ëœ»í•œ ê³µê¸°ê°€ ì„ì´ëŠ” ì•„íŒŒíŠ¸ í˜„ê´€, ìš°í¸í•¨ ê¸ˆì† ëƒ„ìƒˆì™€ ê²½ë¹„ì‹¤ ë¶ˆë¹›",
    // (start) â€” ì²« ë²ˆì§¸ ìœ„ì¹˜, separatorBefore ì—†ìŒ
  },
  {
    index: 1,
    name: "ì—˜ë¦¬ë² ì´í„°",
    nameEn: "Elevator",
    emoji: "ğŸ›—",
    description: "ê±°ìš¸ì´ ë‹¬ë¦° ì—˜ë¦¬ë² ì´í„° ì•ˆ, ë”©ë™ ì†Œë¦¬ê°€ ìš¸ë¦¼",
    separatorBefore: "ë¬¸",
  },
  {
    index: 2,
    name: "ë³µë„",
    nameEn: "Hallway",
    emoji: "ğŸš¶",
    description: "í˜•ê´‘ë“± ë¶ˆë¹›ì´ ë¹„ì¶”ëŠ” ê¸´ ë³µë„, ë°œì†Œë¦¬ê°€ ìš¸ë ¤ í¼ì§",
    separatorBefore: "ë¬¸",
  },
  {
    index: 3,
    name: "í˜„ê´€ë¬¸",
    nameEn: "Front Door",
    emoji: "ğŸšª",
    description: "ë‘êº¼ìš´ ë‚˜ë¬´ í˜„ê´€ë¬¸, ì—´ì‡ ë¡œ ëŒë¦¬ëŠ” ì†Œë¦¬",
    separatorBefore: "ë¬¸",
  },
  {
    index: 4,
    name: "ì‹ ë°œì¥",
    nameEn: "Shoe Cabinet",
    emoji: "ğŸ‘Ÿ",
    description: "í˜„ê´€ ì˜† ì‹ ë°œì¥, ìœ„ì— ì‘ì€ ì¥ì‹ê³¼ ì—´ì‡  ë°”êµ¬ë‹ˆ",
    separatorBefore: "ë‚®ì€ê°€êµ¬",
  },
  {
    index: 5,
    name: "ìš°ì‚°ê½‚ì´",
    nameEn: "Umbrella Stand",
    emoji: "â˜‚ï¸",
    description: "í˜„ê´€ ì½”ë„ˆì˜ ìš°ì‚°ê½‚ì´, ë¹—ë¬¼ ìêµ­ê³¼ ì ‘íŒ ìš°ì‚°ë“¤",
    separatorBefore: "ë‚®ì€ì¹¸ë§‰ì´",
  },
  {
    index: 6,
    name: "ê±°ì‹¤ ì†ŒíŒŒ",
    nameEn: "Living Room Sofa",
    emoji: "ğŸ›‹ï¸",
    description: "ì»¤ë‹¤ë€ Lìí˜• ì†ŒíŒŒ, ë¶€ë“œëŸ¬ìš´ ì¿ ì…˜ì— ëª¸ì´ í‘¹ ë¹ ì§",
    separatorBefore: "ê°€êµ¬",
  },
  {
    index: 7,
    name: "ê±°ì‹¤ TV",
    nameEn: "Television",
    emoji: "ğŸ“º",
    description: "ë²½ì— ê±¸ë¦° í° TV, í™”ë©´ì—ì„œ ë¹›ì´ í¼ì ¸ë‚˜ì˜´",
    separatorBefore: "ë‚®ì€ê°€êµ¬",
  },
  {
    index: 8,
    name: "ì±…ì¥",
    nameEn: "Bookshelf",
    emoji: "ğŸ“š",
    description: "ì²œì¥ê¹Œì§€ ë‹¿ëŠ” í° ì±…ì¥, ì˜¤ë˜ëœ ì¢…ì´ ëƒ„ìƒˆì™€ ë¹¼ê³¡í•œ ì±…ë“¤",
    separatorBefore: "ê°€êµ¬",
  },
  {
    index: 9,
    name: "ì‹íƒ",
    nameEn: "Dining Table",
    emoji: "ğŸ½ï¸",
    description: "4ì¸ìš© ì›ëª© ì‹íƒ, ê·¸ë¦‡ê³¼ ì»µì´ ë†“ì—¬ ìˆìŒ",
    separatorBefore: "ë‚®ì€ì¹¸ë§‰ì´",
  },
  {
    index: 10,
    name: "ì£¼ë°© ì‹±í¬ëŒ€",
    nameEn: "Kitchen Sink",
    emoji: "ğŸš°",
    description: "ìŠ¤í…Œì¸ë¦¬ìŠ¤ ì‹±í¬ëŒ€, ë¬¼ì´ ì¡¸ì¡¸ íë¦„",
    separatorBefore: "ê°€êµ¬",
  },
  {
    index: 11,
    name: "ëƒ‰ì¥ê³ ",
    nameEn: "Refrigerator",
    emoji: "ğŸ§Š",
    description: "ì–‘ë¬¸í˜• ëƒ‰ì¥ê³ , ë¬¸ ì—´ë©´ ì°¨ê°€ìš´ ê³µê¸°ì™€ í•¨ê»˜ ë¹›ì´ ë‚˜ì˜´",
    separatorBefore: "ê°€êµ¬",
  },
  {
    index: 12,
    name: "ì„¸íƒê¸°",
    nameEn: "Washing Machine",
    emoji: "ğŸ§º",
    description: "ìœ ë¦¬ë¬¸ ë„ˆë¨¸ ëŒì•„ê°€ëŠ” ì„¸íƒê¸°, ì›…ì›… ì§„ë™ê³¼ ì„¸ì œ í–¥ê¸°",
    separatorBefore: "ìœ ë¦¬",
  },
  {
    index: 13,
    name: "í™”ì¥ì‹¤ ê±°ìš¸",
    nameEn: "Bathroom Mirror",
    emoji: "ğŸª",
    description: "ê¹€ì„œë¦° ê±°ìš¸ ìœ„ë¡œ ì–¼êµ´ì´ ë¹„ì¹¨, ìŠµí•œ ê³µê¸°ì™€ ë¹„ëˆ„ í–¥",
    separatorBefore: "ë¬¸",
  },
  {
    index: 14,
    name: "ìš•ì¡°/ìƒ¤ì›Œê¸°",
    nameEn: "Bathtub/Shower",
    emoji: "ğŸš¿",
    description: "ë”°ëœ»í•œ ë¬¼ì¤„ê¸°ê°€ ìŸì•„ì§€ëŠ” ìƒ¤ì›Œê¸°, ìˆ˜ì¦ê¸°ì™€ íƒ€ì¼ ë°˜ì§ì„",
    separatorBefore: "ì»¤íŠ¼",
  },
  {
    index: 15,
    name: "ì‘ì€ë°© ì±…ìƒ",
    nameEn: "Study Desk",
    emoji: "ğŸ–¥ï¸",
    description: "ìŠ¤íƒ ë“œ ë¶ˆë¹› ì•„ë˜ ì±…ìƒ, í‚¤ë³´ë“œ ì†Œë¦¬ì™€ ì—°í•„ ëƒ„ìƒˆ",
    separatorBefore: "ë¬¸",
  },
  {
    index: 16,
    name: "ì˜·ì¥",
    nameEn: "Wardrobe",
    emoji: "ğŸ‘”",
    description: "ë‚˜ë¬´ ì˜·ì¥, ì—´ë©´ ë‚˜í”„íƒˆë Œ ëƒ„ìƒˆì™€ ê°€ì§€ëŸ°í•œ ì˜·ë“¤",
    separatorBefore: "ê°€êµ¬",
  },
  {
    index: 17,
    name: "ì¹¨ëŒ€",
    nameEn: "Bed",
    emoji: "ğŸ›ï¸",
    description: "í¬ê·¼í•œ ì´ë¶ˆì´ ë®ì¸ ì¹¨ëŒ€, ë¶€ë“œëŸ¬ìš´ ì¡°ëª…",
    separatorBefore: "ë‚®ì€ê°€êµ¬",
  },
  {
    index: 18,
    name: "ë² ë€ë‹¤",
    nameEn: "Balcony",
    emoji: "ğŸŒ…",
    description: "ìœ ë¦¬ë¬¸ ë„ˆë¨¸ íƒ íŠ¸ì¸ ë°”ê¹¥ í’ê²½, ì‹œì›í•œ ë°”ëŒ",
    separatorBefore: "ìœ ë¦¬",
  },
  {
    index: 19,
    name: "í™”ë¶„/ë¹¨ë˜ê±´ì¡°ëŒ€",
    nameEn: "Plant Pot / Drying Rack",
    emoji: "ğŸŒ±",
    description: "ì´ˆë¡ ìì‚¬ê·€ì™€ í–‡ì‚´, ì –ì€ ë¹¨ë˜ì—ì„œ í’ê¸°ëŠ” ì„¬ìœ ìœ ì—°ì œ í–¥",
    separatorBefore: "ë‚®ì€ì¹¸ë§‰ì´",
  },
];

// ============================================
// ê¸°ë³¸ ì•„íŒŒíŠ¸ 10ê°œ ì¥ì†Œ (í•˜ìœ„ í˜¸í™˜ìš©)
// ì›ë˜ 10ê°œ Locië¥¼ ìœ ì§€ (index ì¬ë§¤í•‘)
// ============================================
export const APARTMENT_LOCI_10: LocusInfo[] = [
  { index: 0, name: "ì—˜ë¦¬ë² ì´í„°", nameEn: "Elevator", emoji: "ğŸ›—", description: "ê±°ìš¸ì´ ë‹¬ë¦° ì—˜ë¦¬ë² ì´í„° ì•ˆ, ë”©ë™ ì†Œë¦¬ê°€ ìš¸ë¦¼", separatorBefore: "ë¬¸" },
  { index: 1, name: "í˜„ê´€ë¬¸", nameEn: "Front Door", emoji: "ğŸšª", description: "ë‘êº¼ìš´ ë‚˜ë¬´ í˜„ê´€ë¬¸, ì—´ì‡ ë¡œ ëŒë¦¬ëŠ” ì†Œë¦¬", separatorBefore: "ë¬¸" },
  { index: 2, name: "ì‹ ë°œì¥", nameEn: "Shoe Cabinet", emoji: "ğŸ‘Ÿ", description: "í˜„ê´€ ì˜† ì‹ ë°œì¥, ìœ„ì— ì‘ì€ ì¥ì‹ê³¼ ì—´ì‡  ë°”êµ¬ë‹ˆ", separatorBefore: "ë‚®ì€ê°€êµ¬" },
  { index: 3, name: "ê±°ì‹¤ ì†ŒíŒŒ", nameEn: "Living Room Sofa", emoji: "ğŸ›‹ï¸", description: "ì»¤ë‹¤ë€ Lìí˜• ì†ŒíŒŒ, ë¶€ë“œëŸ¬ìš´ ì¿ ì…˜ì— ëª¸ì´ í‘¹ ë¹ ì§", separatorBefore: "ê°€êµ¬" },
  { index: 4, name: "TV", nameEn: "Television", emoji: "ğŸ“º", description: "ë²½ì— ê±¸ë¦° í° TV, í™”ë©´ì—ì„œ ë¹›ì´ í¼ì ¸ë‚˜ì˜´", separatorBefore: "ë‚®ì€ê°€êµ¬" },
  { index: 5, name: "ì‹íƒ", nameEn: "Dining Table", emoji: "ğŸ½ï¸", description: "4ì¸ìš© ì›ëª© ì‹íƒ, ê·¸ë¦‡ê³¼ ì»µì´ ë†“ì—¬ ìˆìŒ", separatorBefore: "ë‚®ì€ì¹¸ë§‰ì´" },
  { index: 6, name: "ì£¼ë°© ì‹±í¬ëŒ€", nameEn: "Kitchen Sink", emoji: "ğŸš°", description: "ìŠ¤í…Œì¸ë¦¬ìŠ¤ ì‹±í¬ëŒ€, ë¬¼ì´ ì¡¸ì¡¸ íë¦„", separatorBefore: "ê°€êµ¬" },
  { index: 7, name: "ëƒ‰ì¥ê³ ", nameEn: "Refrigerator", emoji: "ğŸ§Š", description: "ì–‘ë¬¸í˜• ëƒ‰ì¥ê³ , ë¬¸ ì—´ë©´ ì°¨ê°€ìš´ ê³µê¸°ì™€ í•¨ê»˜ ë¹›ì´ ë‚˜ì˜´", separatorBefore: "ê°€êµ¬" },
  { index: 8, name: "ì¹¨ëŒ€", nameEn: "Bed", emoji: "ğŸ›ï¸", description: "í¬ê·¼í•œ ì´ë¶ˆì´ ë®ì¸ ì¹¨ëŒ€, ë¶€ë“œëŸ¬ìš´ ì¡°ëª…", separatorBefore: "ë‚®ì€ê°€êµ¬" },
  { index: 9, name: "ë² ë€ë‹¤", nameEn: "Balcony", emoji: "ğŸŒ…", description: "ìœ ë¦¬ë¬¸ ë„ˆë¨¸ íƒ íŠ¸ì¸ ë°”ê¹¥ í’ê²½, ì‹œì›í•œ ë°”ëŒ", separatorBefore: "ìœ ë¦¬" },
];

// í•˜ìœ„ í˜¸í™˜: DEFAULT_APARTMENT_LOCIëŠ” ì´ì œ 20ê°œ ì „ì²´ë¥¼ ê°€ë¦¬í‚´
export const DEFAULT_APARTMENT_LOCI: LocusInfo[] = FULL_APARTMENT_LOCI;

// ============================================
// ì „í™˜ ë™ì‚¬/ë™ì‘ ì‚¬ì „ (20ê°œ ìœ„ì¹˜, ê° 3 ë³€í˜•)
// ============================================
const TRANSITIONS: Record<string, string[]> = {
  // ì•„íŒŒíŠ¸ ì…êµ¬ â†’ ì—˜ë¦¬ë² ì´í„°
  "0â†’1": [
    "ì•„íŒŒíŠ¸ ì…êµ¬ë¥¼ ì§€ë‚˜ ì—˜ë¦¬ë² ì´í„° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´",
    "ìš°í¸í•¨ì„ í™•ì¸í•˜ê³  ì—˜ë¦¬ë² ì´í„°ë¡œ ê±¸ì–´ê°€ë©´",
    "ë¡œë¹„ì˜ ë”°ëœ»í•œ ê³µê¸°ë¥¼ ëŠë¼ë©° ì—˜ë¦¬ë² ì´í„°ì— íƒ€ë©´",
  ],
  // ì—˜ë¦¬ë² ì´í„° â†’ ë³µë„
  "1â†’2": [
    "ì—˜ë¦¬ë² ì´í„° ë¬¸ì´ ì—´ë¦¬ì ê¸´ ë³µë„ê°€ í¼ì³ì§€ê³ ",
    "ë”©ë™ ì†Œë¦¬ì™€ í•¨ê»˜ ë‚´ë¦¬ë©´ í˜•ê´‘ë“± ë¶ˆë¹› ì•„ë˜ ë³µë„ê°€ ë³´ì´ê³ ",
    "ê±°ìš¸ì— ë¹„ì¹œ ìì‹ ì„ ë³´ë©° ë‚˜ê°€ë©´ ë³µë„ê°€ ì´ì–´ì§€ê³ ",
  ],
  // ë³µë„ â†’ í˜„ê´€ë¬¸
  "2â†’3": [
    "ë³µë„ë¥¼ ë”°ë¼ ê±¸ì–´ê°€ë©´ ìµìˆ™í•œ í˜„ê´€ë¬¸ì´ ë‚˜íƒ€ë‚˜ê³ ",
    "í˜•ê´‘ë“± ì•„ë˜ ë°œì†Œë¦¬ë¥¼ ë‚´ë©° ê±¸ìœ¼ë©´ í˜„ê´€ë¬¸ ì•ì— ë„ì°©í•˜ê³ ",
    "ë³µë„ ëì—ì„œ ì—´ì‡ ë¥¼ êº¼ë‚´ë©´ í˜„ê´€ë¬¸ì´ ë³´ì´ê³ ",
  ],
  // í˜„ê´€ë¬¸ â†’ ì‹ ë°œì¥
  "3â†’4": [
    "í˜„ê´€ë¬¸ì„ ì—´ê³  ë“¤ì–´ì„œë©´ ë°”ë¡œ ì˜† ì‹ ë°œì¥ì´ ë³´ì´ê³ ",
    "ë¬¸ì„ ë°€ê³  ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ë©´ ì‹ ë°œì¥ì´ ëˆˆì— ë“¤ì–´ì˜¤ê³ ",
    "ì—´ì‡ ë¥¼ ëŒë ¤ ë¬¸ì„ ì—´ë©´ ì‹ ë°œì¥ ìœ„ ì¥ì‹ì´ ë°˜ì§ì´ê³ ",
  ],
  // ì‹ ë°œì¥ â†’ ìš°ì‚°ê½‚ì´
  "4â†’5": [
    "ì‹ ë°œì„ ë²—ê³  ì˜†ì„ ë³´ë©´ ìš°ì‚°ê½‚ì´ê°€ ì„œ ìˆê³ ",
    "ì‹ ë°œì¥ì— ì‹ ë°œì„ ë„£ê³  ê³ ê°œë¥¼ ëŒë¦¬ë©´ ìš°ì‚°ê½‚ì´ê°€ ë³´ì´ê³ ",
    "ìŠ¬ë¦¬í¼ë¡œ ê°ˆì•„ ì‹ ê³  ì˜†ì„ ë³´ë©´ ì½”ë„ˆì˜ ìš°ì‚°ê½‚ì´ê°€ ìˆê³ ",
  ],
  // ìš°ì‚°ê½‚ì´ â†’ ê±°ì‹¤ ì†ŒíŒŒ
  "5â†’6": [
    "ìš°ì‚°ê½‚ì´ë¥¼ ì§€ë‚˜ ê±°ì‹¤ë¡œ ë“¤ì–´ì„œë©´ ì†ŒíŒŒê°€ ê¸°ë‹¤ë¦¬ê³ ",
    "í˜„ê´€ì„ ë²—ì–´ë‚˜ ë„“ì€ ê±°ì‹¤ì— ë“¤ì–´ì„œë©´ Lìí˜• ì†ŒíŒŒê°€ ë³´ì´ê³ ",
    "ìš°ì‚°ì„ ê½‚ì•„ë‘ê³  ê±¸ì–´ê°€ë©´ í‘¹ì‹ í•œ ì†ŒíŒŒê°€ ë‚˜íƒ€ë‚˜ê³ ",
  ],
  // ê±°ì‹¤ ì†ŒíŒŒ â†’ ê±°ì‹¤ TV
  "6â†’7": [
    "ì†ŒíŒŒì— ì•‰ì•„ ê³ ê°œë¥¼ ë“¤ë©´ ë²½ì— ê±¸ë¦° TVê°€ ë³´ì´ê³ ",
    "ì†ŒíŒŒ ìœ„ì—ì„œ ì‹œì„ ì„ ì •ë©´ìœ¼ë¡œ ì˜®ê¸°ë©´ TV í™”ë©´ì´ ë¹›ë‚˜ê³ ",
    "ì¿ ì…˜ì„ ì•ˆê³  ì•ì„ ë³´ë©´ TVì—ì„œ ë¹›ì´ í¼ì ¸ë‚˜ì˜¤ê³ ",
  ],
  // ê±°ì‹¤ TV â†’ ì±…ì¥
  "7â†’8": [
    "TVë¥¼ ë„ê³  ì˜†ì„ ë³´ë©´ ì²œì¥ê¹Œì§€ ë‹¿ëŠ” ì±…ì¥ì´ ìˆê³ ",
    "í™”ë©´ì˜ ë¹›ì„ ë”°ë¼ ê³ ê°œë¥¼ ëŒë¦¬ë©´ ë¹¼ê³¡í•œ ì±…ì¥ì´ ë³´ì´ê³ ",
    "ë¦¬ëª¨ì»¨ì„ ë‚´ë ¤ë†“ê³  ì¼ì–´ì„œë©´ í° ì±…ì¥ì´ ëˆˆì•ì— ìˆê³ ",
  ],
  // ì±…ì¥ â†’ ì‹íƒ
  "8â†’9": [
    "ì±…ì¥ì—ì„œ ì±… í•œ ê¶Œì„ êº¼ë‚´ ë“¤ê³  ì‹íƒìœ¼ë¡œ ê±¸ì–´ê°€ë©´",
    "ì˜¤ë˜ëœ ì¢…ì´ ëƒ„ìƒˆë¥¼ ë§¡ìœ¼ë©° ëŒì•„ì„œë©´ ì‹íƒì´ ë³´ì´ê³ ",
    "ì±…ì¥ì„ ì§€ë‚˜ ëª‡ ê±¸ìŒ ì˜®ê¸°ë©´ ì‹íƒì— ë‹¤ë‹¤ë¥´ê³ ",
  ],
  // ì‹íƒ â†’ ì£¼ë°© ì‹±í¬ëŒ€
  "9â†’10": [
    "ì‹íƒì—ì„œ ì ‘ì‹œë¥¼ ë“¤ê³  ì£¼ë°©ìœ¼ë¡œ ê±¸ì–´ê°€ë©´ ì‹±í¬ëŒ€ê°€ ë³´ì´ê³ ",
    "ì‹ì‚¬ë¥¼ ë§ˆì¹˜ê³  ì£¼ë°©ìœ¼ë¡œ ê°€ë©´ ë¬¼ íë¥´ëŠ” ì†Œë¦¬ê°€ ë“¤ë¦¬ê³ ",
    "ì˜ìì—ì„œ ì¼ì–´ë‚˜ ì˜†ìœ¼ë¡œ ê±¸ìœ¼ë©´ ìŠ¤í…Œì¸ë¦¬ìŠ¤ ì‹±í¬ëŒ€ê°€ ë°˜ì§ì´ê³ ",
  ],
  // ì£¼ë°© ì‹±í¬ëŒ€ â†’ ëƒ‰ì¥ê³ 
  "10â†’11": [
    "ì‹±í¬ëŒ€ì—ì„œ ê³ ê°œë¥¼ ëŒë¦¬ë©´ ëƒ‰ì¥ê³ ê°€ ë³´ì´ê³ ",
    "ë¬¼ì„ ì ê·¸ê³  ë’¤ë¥¼ ëŒë©´ ì–‘ë¬¸í˜• ëƒ‰ì¥ê³ ê°€ ì„œ ìˆê³ ",
    "ì –ì€ ì†ì„ ë‹¦ìœ¼ë©° ì˜†ì„ ë³´ë©´ ëƒ‰ì¥ê³  ë¬¸ì´ ë³´ì´ê³ ",
  ],
  // ëƒ‰ì¥ê³  â†’ ì„¸íƒê¸°
  "11â†’12": [
    "ëƒ‰ì¥ê³ ë¥¼ ë‹«ê³  ìœ ë¦¬ë¬¸ ë„ˆë¨¸ë¥¼ ë³´ë©´ ì„¸íƒê¸°ê°€ ëŒì•„ê°€ê³ ",
    "ì°¨ê°€ìš´ ê³µê¸°ë¥¼ ë’¤ë¡œ í•˜ê³  ê±¸ìœ¼ë©´ ì„¸íƒê¸° ì†Œë¦¬ê°€ ë“¤ë¦¬ê³ ",
    "ìŒë£Œë¥¼ ë“¤ê³  ì˜†ë°©ì„ ë³´ë©´ ìœ ë¦¬ ë„ˆë¨¸ ì„¸íƒê¸°ê°€ ë³´ì´ê³ ",
  ],
  // ì„¸íƒê¸° â†’ í™”ì¥ì‹¤ ê±°ìš¸
  "12â†’13": [
    "ì„¸íƒê¸° ì†Œë¦¬ë¥¼ ë’¤ë¡œ í•˜ê³  í™”ì¥ì‹¤ ë¬¸ì„ ì—´ë©´ ê±°ìš¸ì´ ë³´ì´ê³ ",
    "ì„¸ì œ í–¥ì„ ë§¡ìœ¼ë©° ë³µë„ë¥¼ ê±´ë„ˆë©´ í™”ì¥ì‹¤ ê±°ìš¸ì´ ê¹€ìœ¼ë¡œ ë®ì—¬ ìˆê³ ",
    "ë¹¨ë˜ë¥¼ ë„£ê³  ëŒì•„ì„œì„œ í™”ì¥ì‹¤ ë¬¸ì„ ë°€ë©´ ê±°ìš¸ì— ì–¼êµ´ì´ ë¹„ì¹˜ê³ ",
  ],
  // í™”ì¥ì‹¤ ê±°ìš¸ â†’ ìš•ì¡°/ìƒ¤ì›Œê¸°
  "13â†’14": [
    "ê±°ìš¸ ì† ìì‹ ì„ ë³´ë‹¤ ì»¤íŠ¼ ë„ˆë¨¸ ìƒ¤ì›Œê¸°ë¥¼ ì¡ìœ¼ë©´",
    "ê¹€ì„œë¦° ê±°ìš¸ì„ ë‹¦ìœ¼ë©° ê³ ê°œë¥¼ ëŒë¦¬ë©´ ìƒ¤ì›Œê¸°ì—ì„œ ë¬¼ì¤„ê¸°ê°€ íë¥´ê³ ",
    "ë¹„ëˆ„ í–¥ì„ ë§¡ìœ¼ë©° ì»¤íŠ¼ì„ ì—´ë©´ ë”°ëœ»í•œ ìˆ˜ì¦ê¸°ê°€ í”¼ì–´ì˜¤ë¥´ê³ ",
  ],
  // ìš•ì¡°/ìƒ¤ì›Œê¸° â†’ ì‘ì€ë°© ì±…ìƒ
  "14â†’15": [
    "ìƒ¤ì›Œë¥¼ ë§ˆì¹˜ê³  ë³µë„ë¥¼ ê±´ë„ˆ ì‘ì€ë°© ë¬¸ì„ ì—´ë©´ ì±…ìƒì´ ë³´ì´ê³ ",
    "ë”°ëœ»í•œ ë¬¼ê¸°ë¥¼ ë‹¦ê³  ë‚˜ì™€ ë°©ë¬¸ì„ ë°€ë©´ ìŠ¤íƒ ë“œ ë¶ˆë¹›ì´ ë¹„ì¶”ê³ ",
    "ìˆ˜ê±´ìœ¼ë¡œ ë¨¸ë¦¬ë¥¼ ê°ì‹¸ë©° ì˜†ë°©ì— ë“¤ì–´ì„œë©´ ì±…ìƒì´ ê¸°ë‹¤ë¦¬ê³ ",
  ],
  // ì‘ì€ë°© ì±…ìƒ â†’ ì˜·ì¥
  "15â†’16": [
    "ì±…ìƒ ìœ„ ìŠ¤íƒ ë“œë¥¼ ë„ê³  ëŒì•„ì„œë©´ ë‚˜ë¬´ ì˜·ì¥ì´ ì„œ ìˆê³ ",
    "í‚¤ë³´ë“œì—ì„œ ì†ì„ ë–¼ê³  ë’¤ë¥¼ ë³´ë©´ ì˜·ì¥ ë¬¸ì´ ë³´ì´ê³ ",
    "ì—°í•„ì„ ë‚´ë ¤ë†“ê³  ì¼ì–´ë‚˜ ì˜†ì„ ë³´ë©´ ì˜·ì¥ì´ ë‚˜íƒ€ë‚˜ê³ ",
  ],
  // ì˜·ì¥ â†’ ì¹¨ëŒ€
  "16â†’17": [
    "ì˜·ì¥ì—ì„œ ì ì˜·ì„ êº¼ë‚´ ë“¤ê³  ì¹¨ëŒ€ ìª½ìœ¼ë¡œ ê±¸ì–´ê°€ë©´",
    "ë‚˜í”„íƒˆë Œ ëƒ„ìƒˆë¥¼ ë§¡ìœ¼ë©° ë¬¸ì„ ë‹«ê³  ëŒì•„ì„œë©´ ì¹¨ëŒ€ê°€ ë³´ì´ê³ ",
    "ì˜·ê±¸ì´ì— ì˜·ì„ ê±¸ê³  ëŒì•„ì„œë©´ í¬ê·¼í•œ ì´ë¶ˆì´ ê¸°ë‹¤ë¦¬ê³ ",
  ],
  // ì¹¨ëŒ€ â†’ ë² ë€ë‹¤
  "17â†’18": [
    "ì¹¨ëŒ€ì—ì„œ ì¼ì–´ë‚˜ ì»¤íŠ¼ì„ ì—´ë©´ ìœ ë¦¬ë¬¸ ë„ˆë¨¸ ë² ë€ë‹¤ê°€ ë³´ì´ê³ ",
    "ì´ë¶ˆì„ ê±·ì–´ì°¨ê³  ì°½ê°€ë¡œ ê°€ë©´ ë² ë€ë‹¤ì˜ íƒ íŠ¸ì¸ í’ê²½ì´ í¼ì³ì§€ê³ ",
    "ë² ê°œë¥¼ ì•ˆê³  ìœ ë¦¬ë¬¸ ì•ì— ì„œë©´ ë°”ê¹¥ ë°”ëŒì´ ëŠê»´ì§€ê³ ",
  ],
  // ë² ë€ë‹¤ â†’ í™”ë¶„/ë¹¨ë˜ê±´ì¡°ëŒ€
  "18â†’19": [
    "ë² ë€ë‹¤ë¡œ ë‚˜ì„œë©´ í™”ë¶„ê³¼ ë¹¨ë˜ê±´ì¡°ëŒ€ê°€ í–‡ì‚´ ì†ì— ì„œ ìˆê³ ",
    "ì‹œì›í•œ ë°”ëŒì„ ë§ìœ¼ë©° ì˜†ì„ ë³´ë©´ ì´ˆë¡ í™”ë¶„ì´ ë¹›ë‚˜ê³ ",
    "ìœ ë¦¬ë¬¸ì„ ì—´ê³  ë‚˜ê°€ë©´ ê±´ì¡°ëŒ€ ìœ„ ë¹¨ë˜ê°€ ë°”ëŒì— ë‚˜ë¶€ë¼ê³ ",
  ],
};

/**
 * ë‘ Loci ì‚¬ì´ì˜ ê¸°ë³¸ ì „í™˜ ë¬¸êµ¬ ë°˜í™˜
 */
export function getTransition(fromIndex: number, toIndex: number): string {
  const key = `${fromIndex}â†’${toIndex}`;
  const options = TRANSITIONS[key];
  if (options && options.length > 0) {
    return options[Math.floor(Math.random() * options.length)];
  }
  // í´ë°±: ì§ì ‘ì ì¸ ì´ë™ í‘œí˜„ ìƒì„±
  const fromLocus = FULL_APARTMENT_LOCI[fromIndex];
  const toLocus = FULL_APARTMENT_LOCI[toIndex];
  if (fromLocus && toLocus) {
    return `${fromLocus.name}ì—ì„œ ${toLocus.name}(ìœ¼)ë¡œ ì´ë™í•˜ë©´`;
  }
  return `${fromIndex}ë²ˆ ìœ„ì¹˜ì—ì„œ ${toIndex}ë²ˆ ìœ„ì¹˜ë¡œ ì´ë™í•˜ë©´`;
}

/**
 * í‚¤ì›Œë“œ ë°°ì—´ì„ ë°›ì•„ ì „ì²´ ê¶ì „ ë‚´ëŸ¬í‹°ë¸Œ ìƒì„±
 * (ê¸°ë³¸ ê³¨ê²© â€” AI ì—ì´ì „íŠ¸ê°€ ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í’ì„±í•˜ê²Œ í™•ì¥)
 */
export function generateBasicNarrative(
  verseRef: string,
  keywords: Array<{ locusIndex: number; keyword: string; image: string }>
): PalaceNarrative {
  const connections: StoryConnection[] = [];
  const storyParts: string[] = [];

  // ì²« ì§€ì 
  if (keywords.length > 0) {
    const first = keywords[0];
    const locus = FULL_APARTMENT_LOCI[first.locusIndex];
    if (locus) {
      storyParts.push(
        `${locus.emoji} ${locus.name}ì— ë„ì°©í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ${first.image}(ì´/ê°€) ë³´ì…ë‹ˆë‹¤.`
      );
    }
  }

  // ì—°ê²° ì´ì•¼ê¸°
  for (let i = 0; i < keywords.length - 1; i++) {
    const from = keywords[i];
    const to = keywords[i + 1];
    const transition = getTransition(from.locusIndex, to.locusIndex);
    const toLocus = FULL_APARTMENT_LOCI[to.locusIndex];

    if (toLocus) {
      const story = `${transition} ${toLocus.emoji} ${toLocus.name}ì—ì„œ ${to.image}(ì´/ê°€) ë‚˜íƒ€ë‚©ë‹ˆë‹¤.`;

      connections.push({
        fromLocus: from.locusIndex,
        toLocus: to.locusIndex,
        story,
        transitionType: "walk",
      });

      storyParts.push(story);
    }
  }

  return {
    title: `${verseRef} ê¸°ì–µì˜ ê¶ì „`,
    verseRef,
    totalLoci: keywords.length,
    connections,
    fullStory: storyParts.join("\n\n"),
  };
}
